#!/bin/bash
export PATH="/srv/kvm/OSX-KVM/bin:$PATH"
set -o pipefail 

CPATH="$2"
MACHINE="$1" 
TAGS="$3"

function usage() {
	echo "Usage: "
	echo "backup-container MACHINE PATH [TAG1 TAG2 ... TAGn]"
}

[[ -z $CPATH ]] && usage && exit 1
[[ -z $MACHINE ]] && usage && exit 2


TAGS="container:$MACHINE $TAGS"
for i in  $TAGS ; do
	_TAGS="$_TAGS --tag \"$i\""
done

echo backup-cmd backup "$CPATH" $_TAGS   
backup-cmd backup "$CPATH" /etc/systemd/nspawn/$MACHINE.nspawn $_TAGS   
